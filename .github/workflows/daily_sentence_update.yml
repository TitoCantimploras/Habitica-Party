name: æ¯æ—¥å¥å­æ›´æ–°

on:
  schedule:
    - cron: '0 9 * * *'  # æ¯å¤© UTC æ—¶é—´ 9 ç‚¹è§¦å‘
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  update_daily_sentence:
    runs-on: ubuntu-latest

    steps:
      - name: è·å–æ¯æ—¥å¥å­
        id: get_sentence
        run: |
          # ä» API è·å–æ¯æ—¥å¥å­
          response=$(curl -s "https://sentence.iciba.com/?c=dailysentence&m=getTodaySentence")
          echo "å“åº”: $response"
          # æå–å¥å­å†…å®¹å’Œç¿»è¯‘
          content=$(echo $response | jq -r '.content')
          translation=$(echo $response | jq -r '.note')
          # å°†å†…å®¹å’Œç¿»è¯‘å­˜å‚¨åˆ°ç¯å¢ƒå˜é‡ä¸­
          echo "content=$content" >> $GITHUB_ENV
          echo "translation=$translation" >> $GITHUB_ENV

      - name: æ›´æ–° Habitica é˜Ÿä¼æè¿°
        run: |
          # å‘é€ PUT è¯·æ±‚æ›´æ–° Habitica å°ç»„çš„æè¿°
          curl -X PUT "https://habitica.com/api/v3/groups/party" \
          -H "x-api-user: ${{ secrets.HABITICA_USER_ID }}" \
          -H "x-api-key: ${{ secrets.HABITICA_API_KEY }}" \
          -H "Content-Type: application/json" \
          -d '{
            "description": "ä¸€è¨€ Â· A sentence of the day ğŸŒ¹\n\n'"${{ env.content }}"'\n\n'"${{ env.translation }}"'\n\nWant to learn more about the party's purpose, rules, and other information? (Click here!)[https://github.com/Delta-Water/Habitica-Party/blob/main/README.md]"
          }'