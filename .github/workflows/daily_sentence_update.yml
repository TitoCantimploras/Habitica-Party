name: æ¯æ—¥å¥å­æ›´æ–°

on:
  schedule:
    - cron: '0 9 * * *'  # æ¯å¤© UTC æ—¶é—´ 9 ç‚¹è§¦å‘
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  update_daily_sentence:
    runs-on: ubuntu-latest

    steps:
      - name: è®¾ç½® Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: å®‰è£…ä¾èµ–
        run: |
          pip install requests

      - name: è·å–æ¯æ—¥å¥å­å¹¶æ›´æ–° Habitica
        run: |
          import os
          import requests

          # è·å–æ¯æ—¥å¥å­
          response = requests.get("https://sentence.iciba.com/?c=dailysentence&m=getTodaySentence")
          response_data = response.json()
          content = response_data['content']
          translation = response_data['note']

          # æ›´æ–° Habitica å°ç»„æè¿°
          url = "https://habitica.com/api/v3/groups/party"
          headers = {
              "x-api-user": os.getenv("HABITICA_USER_ID"),
              "x-api-key": os.getenv("HABITICA_API_KEY"),
              "Content-Type": "application/json"
          }
          description = f"### ä¸€è¨€ Â· A sentence of the day ğŸŒ¹\n\n{content}\n\n{translation}\n\n#### Want to learn more about the party's purpose, rules, and other information? [Click here!](https://github.com/Delta-Water/Habitica-Party/blob/main/README.md)"
          data = {"description": description}

          response = requests.put(url, headers=headers, json=data)
          print(response.json())